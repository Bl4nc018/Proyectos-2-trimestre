openapi: "3.0.0"
info:
  version: 1.0.0
  title: AirPeekAPI
servers:
  - url: http://localhost:8000
tags:
  - name: User
    description: User actions 
  - name: Flights
    description: Flights info
paths:
  /login:
    post:
      tags:
        - User
      summary: Logs user into the system
      operationId: loginUser
      parameters:
        - name: email
          in: query
          required: true
          description: The email of the user
          schema:
            type: string 
        - name: password
          in: query
          required: true
          description: The password of the user
          schema:
            type: string
      security:
        - bearerAuth: []
      responses:
        200:
          description: Email exists and password is correct
          content:
            application/json:    
              schema:
                example:
                  token: 19273348274832
        404:
          description: The email doesn't exist
          content:
            application/json:
              schema:
                example:
                  token: Email already registered
        401:
          description: The email or the password are not valid
          content:
            application/json:
              schema:
                example:
                  token: Invalid email or password
  /register:
    post:
      tags:
        - User
      summary: Register a new user
      parameters:
        - name: name
          in: query
          required: true
          description: The full name of the user
          schema:
            type: string
        - name: email
          in: query
          required: true
          description: The email of the user
          schema:
            type: string
          example: "matusalen@fpcoruna.afundacion.org"
        - name: country
          in: query
          required: true
          description: The user's home country
          schema:
            type: string
          example: "España"
        - name: password
          in: query
          required: true
          description: The user's password
          schema:
            type: string
        - name: birthdate
          in: query
          required: true
          description: The user's birthdate
          schema:
            type: string
          example: "24/03/2001"
      responses:
        200:
          description: User registered
          content:
            application/json:    
              schema:
                example:
                  register: ok
        400:
          description: Any parameter is not valid
          content:
            application/json:    
              schema:
                example:
                  register: not_ok
  /profile:
    get:
      tags:
        - User
      summary: Get user profile
      security:
        - bearerAuth: []
      responses:
        200:
          description: User profile retrieved
          content:
            application/json:    
              schema:
                type: object
                properties:
                  name:
                    type: string
                  email:
                    type: string
                  country:
                    type: string
                  birthdate:
                    type: string
        400:
          description: Any parameter is not valid
          content:
            application/json:    
              schema:
                example:
                  message: not_ok
  /edit_profile:
    put:
      tags:
        - User
      summary: Update user profile
      security:
        - bearerAuth: []
      parameters:
        - name: name
          in: query
          required: true
          description: The full name of the user
          schema:
            type: string
        - name: email
          in: query
          required: true
          description: The email of the user
          schema:
            type: string
          example: "matusalen@fpcoruna.afundacion.org"
        - name: country
          in: query
          required: true
          description: The user's home country
          schema:
            type: string
          example: "España"
        - name: password
          in: query
          required: true
          description: The user's password
          schema:
            type: string
        - name: birthdate
          in: query
          required: true
          description: The user's birthdate
          schema:
            type: string
          example: "24/03/2001"
      responses:
        200:
          description: User profile updated
          content:
            application/json:    
              schema:
                example:
                  update: ok
        400:
          description: Any parameter is not valid
          content:
            application/json:    
              schema:
                example:
                  update: not_ok
  /delete_account:
    delete:
      tags:
        - User
      summary: Delete user account
      security:
        - bearerAuth: []
      responses:
        200:
          description: User account deleted
          content:
            application/json:    
              schema:
                example:
                  delete: ok
        401:
          description: Unauthorized
          content:
            application/json:    
              schema:
                example:
                  message: Unauthorized
  /flights:
    get:
      tags:
        - User
      summary: Get all flights added to user
      description: Returns a list of all flights
      responses:
        200:
          description: A list of flights
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    origin:
                      type: string
                    destination:
                      type: string
                    depart_date:
                      type: string
                      format: date-time
                    return_date:  
                      type: string
                      format: date-time
                    value:  ## Precio.
                      type: number
                    number_of_changes: ## Número de transbordos.
                      type: integer
        404:
          description: No flights found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
  /delete_flight/{id}:
    delete:
      tags:
        - User
      summary: Delete a flight
      parameters:
        - name: id
          in: path
          required: true
          description: The ID of the flight to delete
          schema:
            type: integer
      responses:
        200:
          description: Flight deleted
          content:
            application/json:    
              schema:
                example:
                  delete: Flight deleted
        404:
          description: Flight not found
          content:
            application/json:    
              schema:
                example:
                  message: Flight not found
  /special-offers:
    get:
      tags:
        - Flights
      summary: Get special offers which can interest the user
      description: Returns a list of some special flight offers that stand out for being affordable
      responses:
        200:
          description: A list of special offers
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    origin:
                      type: string
                    destination:
                      type: string
                    depart_date:
                      type: string
                      format: date-time
                    return_date: 
                      type: string
                      format: date-time
                    value:  ## Precio.
                      type: number
                    number_of_changes: ## Número de transbordos.
                      type: integer
        404:
          description: No special offers found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string